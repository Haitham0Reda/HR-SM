# MongoDB Replica Set Configuration for HRMS
# This configuration supports both main database (hrms) and license database (hrsm-licenses)

# Storage configuration
storage:
  dbPath: /var/lib/mongodb
  journal:
    enabled: true
  wiredTiger:
    engineConfig:
      cacheSizeGB: 2
      journalCompressor: snappy
      directoryForIndexes: true
    collectionConfig:
      blockCompressor: snappy
    indexConfig:
      prefixCompression: true

# Network configuration
net:
  port: 27017
  bindIp: 0.0.0.0
  maxIncomingConnections: 1000
  wireObjectCheck: true
  ipv6: false

# Process management
processManagement:
  fork: true
  pidFilePath: /var/run/mongodb/mongod.pid
  timeZoneInfo: /usr/share/zoneinfo

# Security configuration
security:
  authorization: enabled
  keyFile: /etc/mongodb/keyfile
  clusterAuthMode: keyFile

# Replication configuration
replication:
  replSetName: "hrms-replica-set"
  oplogSizeMB: 1024

# Sharding (if needed for scaling)
# sharding:
#   clusterRole: shardsvr

# Logging
systemLog:
  destination: file
  logAppend: true
  path: /var/log/mongodb/mongod.log
  logRotate: reopen
  component:
    accessControl:
      verbosity: 1
    command:
      verbosity: 1
    query:
      verbosity: 1
    replication:
      verbosity: 1
    storage:
      verbosity: 1

# Operation profiling
operationProfiling:
  mode: slowOp
  slowOpThresholdMs: 100
  slowOpSampleRate: 1.0

# Set parameters for performance
setParameter:
  enableLocalhostAuthBypass: false
  authenticationMechanisms: SCRAM-SHA-1,SCRAM-SHA-256
  maxLogSizeKB: 10240
  logLevel: 1
  cursorTimeoutMillis: 600000
  failIndexKeyTooLong: false
  notablescan: false
  
# Connection pool settings
# These are applied at the application level, not server level
# Included here for reference:
#
# Application connection settings (for Node.js driver):
# - maxPoolSize: 100
# - minPoolSize: 5
# - maxIdleTimeMS: 30000
# - waitQueueTimeoutMS: 5000
# - serverSelectionTimeoutMS: 5000
# - socketTimeoutMS: 0
# - family: 4